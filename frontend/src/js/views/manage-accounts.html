<!-- Fullscreen Wrapper -->
<div class="oj-flex oj-sm-flex-direction-column"
  style="width:100vw; padding:10px; box-sizing:border-box;">

  <!-- Heading -->
  <div class="oj-flex-item">
    <h2>Accounts Management</h2>
  </div>

  <!-- Accounts Table (takes rest of screen) -->
  <div class="oj-flex-item oj-sm-flex-1" style="overflow:auto;">
    <oj-table id="accountsTable" aria-label="Accounts" data="[[accountDataProvider]]" selection-mode='{"row": "single"}'
      class="oj-sm-width-full oj-sm-height-full" columns='[
                {"headerText":"Account ID","field":"id"},
                {"headerText":"Account Number","field":"accountNumber"},
                {"headerText":"Account Type","field":"accountType"},
                {"headerText":"Balance","field":"balance"},
                {"headerText":"Status","field":"status"},
                {"headerText":"Action","field":"action","template":"actionTemplate","minWidth":"200px"}
              ]'>

      <!-- Action Template -->
      <template slot="actionTemplate" data-oj-as="row">
        <div class="oj-flex oj-sm-flex-direction-column oj-sm-justify-content-center">
          <oj-button chroming="callToAction" display="all" class="oj-sm-width-full" label="View Transactions"
            on-oj-action="[[viewTransactions]]">
          </oj-button>

          <oj-button chroming="danger" display="all" class="oj-sm-width-full" label="Block"
            on-oj-action="[[viewTransactions]]">
          </oj-button>
        </div>
      </template>
    </oj-table>
  </div>
</div>



<!-- Transactions Dialog -->
<oj-dialog id="transactionsDialog" dialog-title="Transactions" modality="modal" style="width:800px;height:600px;">
  <div slot="body" class="oj-sm-padding-4x">
    <h4>Transactions for Account: <oj-bind-text value="[[selectedAccount() ? selectedAccount().accountNumber : '']]"></oj-bind-text></h4>

    <oj-table id="transactionsTable"
              aria-label="Transactions"
              data="[[transactionDataProvider]]"
              columns='[
                 {"headerText": "Transaction ID","field":"transactionId"},  
                {"headerText":"Date","field":"formattedDate"},
                {"headerText":"Description","field":"description"},
                {"headerText":"Debit","field":"debit","template":"debitTemplate"},
                {"headerText":"Credit","field":"credit","template":"creditTemplate"}
              ]'>


                <!-- Debit (red text if not null) -->
                <template slot="debitTemplate" data-oj-slot="debit">
                  <oj-bind-if test="[[$current.data != null]]">
                    <span class="oj-text-color-danger">
                      ₹<oj-bind-text value="[[$current.data]]"></oj-bind-text>
                    </span>
                  </oj-bind-if>
                  <oj-bind-if test="[[$current.data==null]]">--</oj-bind-if>
                </template>
                
                <!-- Credit (green text if not null) -->
                <template slot="creditTemplate" data-oj-slot="credit">
                  <oj-bind-if test="[[$current.data != null]]">
                    <span class="oj-text-color-success">
                      ₹<oj-bind-text value="[[$current.data]]"></oj-bind-text>
                    </span>
                  </oj-bind-if>
                  </oj-bind-if>
                  <oj-bind-if test="[[$current.data==null]]">--</oj-bind-if>
                </template>
    </oj-table>
  </div>

  <div slot="footer" class="oj-sm-justify-content-flex-end">
    <oj-button on-oj-action="[[closeTransactions]]">Close</oj-button>
  </div>
</oj-dialog>
